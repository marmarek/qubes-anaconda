From b52811b3ad6278f3ed721c2b3a08e542ad0f9e32 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Fr=C3=A9d=C3=A9ric=20Pierret=20=28fepitre=29?=
 <frederic.epitre@orange.fr>
Date: Sat, 10 Nov 2018 19:17:45 +0100
Subject: [PATCH] lock root account by default

---
 pyanaconda/installclasses/qubes.py | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/pyanaconda/installclasses/qubes.py b/pyanaconda/installclasses/qubes.py
index debdc0f42..8f4ced67f 100644
--- a/pyanaconda/installclasses/qubes.py
+++ b/pyanaconda/installclasses/qubes.py
@@ -19,7 +19,7 @@
 
 from pyanaconda.installclass import BaseInstallClass
 from pyanaconda.modules.common.constants.objects import AUTO_PARTITIONING
-from pyanaconda.modules.common.constants.services import NETWORK, STORAGE, TIMEZONE
+from pyanaconda.modules.common.constants.services import NETWORK, STORAGE, TIMEZONE, USERS
 from pyanaconda.product import *
 from pyanaconda.core.i18n import N_
 import pyanaconda.platform
@@ -69,6 +69,11 @@ class InstallClass(BaseInstallClass):
         timezone_proxy = TIMEZONE.get_proxy()
         timezone_proxy.SetNTPEnabled(False)
 
+        # Make locked root account by default
+        users_proxy = USERS.get_proxy()
+        users_proxy.SetRootAccountLocked(True)
+
+
     def setDefaultPartitioning(self, storage):
         BaseInstallClass.setDefaultPartitioning(self, storage)
         for autoreq in storage.autopart_requests:
-- 
2.17.2

